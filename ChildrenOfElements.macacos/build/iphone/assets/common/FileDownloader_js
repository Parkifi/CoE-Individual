function FileDownloader(){}FileDownloader.prototype.mainLoader,FileDownloader.prototype.downloadOneFile=function(e,t,i){var o=e+"?nocache="+Math.floor(1300*Math.random()),n=Titanium.Network.createHTTPClient();null!=i&&(n.onerror=function(e){Ti.API.info("MyApp: Download failed: url= "+o+" Error="+e.error),i({status:e.error,path:""})},n.onload=function(){i({status:n.status,path:t}),n=null}),n.open("GET",o),null!=t&&(Ti.API.info("MyApp:  (iOS) Downloaded this file from server:."+t),n.file=Titanium.Filesystem.getFile(t)),n.send()},FileDownloader.prototype.downloadMultiFile=function(e,t,i){var o=this.filterDuplicates(e);Ti.API.info(o[0]);var n=0;if(this.mainLoader)var r=this.mainLoader;var a=function(e){if("undefined"!=typeof e){var s=100/o.length,l=8.14,u=0;if(r){var c=n*s*l+u;if(c>1&&100>s){var d=Ti.UI.createAnimation({left:c,duration:100});r.children[0].children[1].animate(d)}}t(e,s)}o.length>n?(FileDownloader.prototype.downloadOneFile(o[n].url,o[n].filepath,a),n++):(r&&(r.visible=!1,r=null),i())};a()},FileDownloader.prototype.checkUpdate=function(e){var t,i=Alloy.Globals.remoteServerRoot+"lastUpdate.json?nocache="+Math.floor(1300*Math.random()),o=Ti.Network.createHTTPClient({onload:function(){t=JSON.parse(this.responseText);var i=new Date(t.lastUpdate.toString()),o=new Date(Ti.App.Properties.getString("lastUpdate"));i.getTime()>o.getTime()?(Ti.App.Properties.setString("lastUpdate",i),e(!0)):e(!1)},onerror:function(e){Ti.API.debug("error reading last update "+e.error)}});o.open("GET",i),o.send()},FileDownloader.prototype.checkUpdateMenu=function(e,t){var i=new Date(e.toString()),o=new Date(Ti.App.Properties.getString("lastUpdate"));t(i.getTime()>=o.getTime()?!0:!1)},FileDownloader.prototype.makeQueue=function(e){var t=[],i=this.filterDuplicates(e);if(i instanceof Array)for(var o=0;i.length>o;o++)t.push({filepath:Titanium.Filesystem.applicationCacheDirectory+i[o],url:Alloy.Globals.remoteServerRoot+i[o]});else Ti.API.info("ERROR: parameter is not a valid array");return t},FileDownloader.prototype.setLoaderScreen=function(e){this.mainLoader=e,this.mainLoader.visible=!0},FileDownloader.prototype.calculatePercent=function(e,t){var i=100/e;return this.mainLoader&&(this.mainLoader.children[0].width=6*t*i),t*i},FileDownloader.prototype.startloader=function(){},FileDownloader.prototype.forceFile=function(){var e=Ti.Filesystem.getFile(Ti.Filesystem.applicationCacheDirectory,"emptyfile.txt");e.write("The file is no longer empty! 50  >> 50"),Ti.API.info(e.exists?"[saveFile] Saved: YES! ("+e.nativePath+")":"[saveFile] Saved: NO!");var t=Ti.Filesystem.getFile(Ti.Filesystem.applicationCacheDirectory,"emptyfile.txt");t.read()},FileDownloader.prototype.filterDuplicates=function(e){var t=e.filter(function(t,i){return e.indexOf(t)==i});return t},module.exports=FileDownloader;