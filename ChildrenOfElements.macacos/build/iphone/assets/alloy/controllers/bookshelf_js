function __processArg(t,e){var i=null;return t&&(i=t[e]||null,delete t[e]),i}function Controller(){function t(t){A&&("blur"==t.type&&s(),"focus"==t.type&&r(),A=!1,T=setTimeout(function(){A=!0},200))}function e(){function t(t){if(m.populateTable(),u.bookshelf.removeEventListener("open",e),v=new g(m.getDefaultMesage(),d),u.aboutText.text=m.getAboutMessage(),u.bookshelf.add(v.getContainer()),t){var i=new Date(t),o=new Date(i.getTime()+6e4);Ti.App.Properties.setString("lastUpdate",o),currentDate=Ti.App.Properties.getString("lastUpdate")}}if(Titanium.Network.networkType==Titanium.Network.NETWORK_NONE&&"March 13, 2014 11:36"==Ti.App.Properties.getString("lastUpdate")){currentDate=Ti.App.Properties.getString("lastUpdate");var i=Titanium.UI.createAlertDialog({title:"Internet Connection not found",message:"Please try again later.",buttonNames:["OK"]});return void i.show()}w.url="/audio/bookshelf-opt.mp3",w.looping=!0,r(),"es"==Alloy.Globals.userLanguage&&(u.toolbar_button_suscribe.image="/bookshelf/bookshelf_navigator_suscribe_es.png"),u.bookshelf_play.visible=!1,u.thumbnailPre.visible=!1;var o=u.aboutText;m=new f(b.currentItem.id,o,d),u.bookshelf.add(m.loadingScreen),m.loadThumbnails(t),u.bookshelf.add(m.getTable())}function i(t){v.setData(t.bookData),v.isPreview()?(u.bookshelf_play.visible=!1,u.thumbnailPre.visible=!1):(u.bookshelf_play.visible=!0,u.thumbnailPre.visible=!0),u.thumbnail.visible=!0,y=t.bookData.storyID,v.showDetails(),p.logEvent("StoryDetailsClick",{storyID:y})}function o(){function t(){r(),u.bookshelf.removeEventListener("focus",t)}if(Titanium.Network.networkType==Titanium.Network.NETWORK_NONE&&!Ti.App.Properties.getString("bookID_"+y)){var e=Titanium.UI.createAlertDialog({title:"Internet Connection not found",message:"Please try again later.",buttonNames:["OK"]});return void e.show()}if(y){p.logEvent("StoryOpenClick",{storyID:y});var i=Alloy.createController("storyViewer",{storyID:y}).getView();i.open({fullscreen:!0,navBarHidden:!0,exitOnClose:!0}),i=null,delete i,s(),u.bookshelf.addEventListener("focus",t)}}function r(){Ti.App.Properties.getString("bookshelfAudioStatus")||Ti.App.Properties.setString("bookshelfAudioStatus","enabled"),"disabled"==Ti.App.Properties.getString("bookshelfAudioStatus")?(w.stop(),u.toolbar_button_mute.image="/bookshelf/bookshelf_navigator_sound_off.png"):(w.play(),u.toolbar_button_mute.image="/bookshelf/bookshelf_navigator_sound.png")}function s(){w.stop()}function n(){if(A){w.playing?(w.stop(),u.toolbar_button_mute.image="/bookshelf/bookshelf_navigator_sound_off.png",Ti.App.Properties.setString("bookshelfAudioStatus","disabled")):(w.play(),u.toolbar_button_mute.image="/bookshelf/bookshelf_navigator_sound.png",Ti.App.Properties.setString("bookshelfAudioStatus","enabled"));var t=Ti.Media.createSound({url:"/audio/fx/click1_topmenu.mp3"});t.play(),t=null,A=!1,T=setTimeout(function(){A=!0},1e3)}}function a(){if("es"==Alloy.Globals.userLanguage)var t=Ti.UI.createAlertDialog({confirm:0,message:"Sua avaliação nos estimula a criar!",title:"Gostou do que viu?"});else var t=Ti.UI.createAlertDialog({confirm:0,message:"Sua avaliação nos estimula a criar!",title:"Gostou do que viu?"});t.show();var e=Ti.Media.createSound({url:"/audio/fx/click1_topmenu.mp3"});e.play(),e=null}function l(){p.logEvent("SuscribeClick",{click:"true"});var t=Titanium.UI.createAnimation({opacity:1,duration:600});u.aboutImage.touchEnabled=!0,u.aboutImage.zIndex=100,u.aboutImage.width="100%",u.aboutImage.height="100%",u.aboutImage.animate(t),u.aboutImage.addEventListener("click",function(){var t=Titanium.UI.createAnimation({opacity:0,duration:600});u.aboutImage.animate(t),u.aboutImage.touchEnabled=!1,u.aboutImage.width="0%",u.aboutImage.height="0%"});var e=Ti.Media.createSound({url:"/audio/fx/click1_topmenu.mp3"});e.play(),e=null}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="bookshelf",arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var u=this,h={},c={};u.__views.bookshelf=Ti.UI.createWindow({backgroundImage:"/bookshelf/bookshelf_background.png",id:"bookshelf"}),u.__views.bookshelf&&u.addTopLevelView(u.__views.bookshelf),u.__views.contentSelect=Ti.UI.createView({id:"contentSelect"}),u.__views.bookshelf.add(u.__views.contentSelect),u.__views.bookshelf_toolBar=Ti.UI.createView({height:102,width:380,top:0,right:25,id:"bookshelf_toolBar"}),u.__views.bookshelf.add(u.__views.bookshelf_toolBar),u.__views.toolbar_button_mute=Ti.UI.createImageView({width:98,height:97,left:110,top:0,id:"toolbar_button_mute",image:"/bookshelf/bookshelf_navigator_sound.png"}),u.__views.bookshelf_toolBar.add(u.__views.toolbar_button_mute),n?u.__views.toolbar_button_mute.addEventListener("click",n):c["$.__views.toolbar_button_mute!click!toggleAudio"]=!0,u.__views.toolbar_button_suscribe=Ti.UI.createImageView({width:101,height:91,left:220,top:0,id:"toolbar_button_suscribe",image:"/bookshelf/bookshelf_navigator_suscribe.png"}),u.__views.bookshelf_toolBar.add(u.__views.toolbar_button_suscribe),l?u.__views.toolbar_button_suscribe.addEventListener("click",l):c["$.__views.toolbar_button_suscribe!click!suscribe"]=!0,u.__views.toolbar_button_home=Ti.UI.createImageView({width:93,height:93,left:0,top:0,id:"toolbar_button_home",image:"/bookshelf/bookshelf_navigator_home.png"}),u.__views.bookshelf_toolBar.add(u.__views.toolbar_button_home),a?u.__views.toolbar_button_home.addEventListener("click",a):c["$.__views.toolbar_button_home!click!openFaceBook"]=!0,u.__views.bookshelf_play=Ti.UI.createImageView({bottom:330,right:50,width:92,zIndex:10,height:89,visible:0,image:"/bookshelf/bookshelf_buton_play_bw.png",id:"bookshelf_play"}),u.__views.bookshelf.add(u.__views.bookshelf_play),u.__views.thumbnail=Ti.UI.createImageView({right:40,bottom:12,width:363,height:334,visible:0,id:"thumbnail"}),u.__views.bookshelf.add(u.__views.thumbnail),u.__views.thumbnailPre=Ti.UI.createImageView({bottom:33,right:55,width:345,height:258,backgroundColor:"transparent",touchEnabled:!0,zIndex:100,id:"thumbnailPre"}),u.__views.bookshelf.add(u.__views.thumbnailPre),u.__views.aboutImage=Ti.UI.createView({top:0,left:0,width:"0%",height:"0%",opacity:"0",id:"aboutImage",backgroundColor:"#55FFFFFF"}),u.__views.bookshelf.add(u.__views.aboutImage),u.__views.__alloyId0=Ti.UI.createView({backgroundImage:"/about/aboutScreen_window.png",width:"814",height:"569",id:"__alloyId0"}),u.__views.aboutImage.add(u.__views.__alloyId0),u.__views.aboutText=Ti.UI.createLabel({width:"80%",top:80,color:"#000000",touchEnabled:!1,font:{fontSize:20,fontFamily:Alloy.Globals._font_oldenburg},id:"aboutText"}),u.__views.__alloyId0.add(u.__views.aboutText),h.destroy=function(){},_.extend(u,u.__views);var d,p=require("com.onecowstanding.flurry");p.debugLogEnabled=!0,p.eventLoggingEnabled=!0,p.sessionReportsOnCloseEnabled=!0,p.sessionReportsOnPauseEnabled=!0,p.sessionReportsOnActivityChangeEnabled=!0,p.secureTransportEnabled=!1,p.logPageView();var f=require("/common/BookMenu"),g=require("/common/BookDetails"),b=arguments[0]||{};b.currentItem;var m,v,y,T,w=Ti.Media.createSound(),A=!0;u.bookshelf.addEventListener("open",e),u.bookshelf.addEventListener("showBookDetails",i),u.bookshelf_play.addEventListener("click",o),u.bookshelf_play.addEventListener("touchstart",function(t){t.source.image="/bookshelf/bookshelf_buton_play.png";var e=Ti.Media.createSound({url:"/audio/fx/click2-bookselection.mp3"});e.play(),e=null}),u.bookshelf_play.addEventListener("touchend",function(t){t.source.image="/bookshelf/bookshelf_buton_play_bw.png"}),u.thumbnailPre.addEventListener("click",o),u.bookshelf.addEventListener("android:back",function(t){t.cancelBubble=!0}),u.bookshelf.addEventListener("blur",t),u.bookshelf.addEventListener("close",t),u.bookshelf.addEventListener("focus",t),u.bookshelf.addEventListener("open",t),c["$.__views.toolbar_button_mute!click!toggleAudio"]&&u.__views.toolbar_button_mute.addEventListener("click",n),c["$.__views.toolbar_button_suscribe!click!suscribe"]&&u.__views.toolbar_button_suscribe.addEventListener("click",l),c["$.__views.toolbar_button_home!click!openFaceBook"]&&u.__views.toolbar_button_home.addEventListener("click",a),_.extend(u,h)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;